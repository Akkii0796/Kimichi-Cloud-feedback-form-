<!DOCTYPE html>
<html lang="mr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>Kimchi Cloud - Feedback</title>

  <style>
    :root{
      --bg1:#dc2626;
      --bg2:#7f1d1d;

      --card:#ffffff;
      --text:#0f172a;
      --muted:#64748b;

      --red:#dc2626;
      --red2:#991b1b;

      --ring: rgba(220,38,38,0.18);

      --radius-xl:20px;
      --radius-lg:16px;
      --radius-md:14px;
      --radius-sm:12px;

      --shadow-1: 0 6px 18px rgba(0,0,0,0.10);
      --shadow-2: 0 12px 28px rgba(0,0,0,0.14);
      --shadow-press: 0 6px 16px rgba(0,0,0,0.12);

      --border: rgba(2,6,23,0.08);
      --border-strong: rgba(2,6,23,0.12);
    }

    * { margin:0; padding:0; box-sizing:border-box; -webkit-tap-highlight-color: transparent; }
    body{
      font-family: -apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,sans-serif;
      background: radial-gradient(1200px 600px at 20% 10%, rgba(255,255,255,0.12), transparent 40%),
                  linear-gradient(135deg, var(--bg1) 0%, var(--bg2) 100%);
      min-height:100vh;
      padding:12px;
      overflow-x:hidden;
      color: var(--text);
    }

    .container{
      max-width:420px;
      margin: 0 auto;
      background: var(--card);
      border-radius: var(--radius-xl);
      overflow:hidden;
      box-shadow: 0 18px 60px rgba(0,0,0,0.28);
      border: 1px solid rgba(255,255,255,0.08);
    }

    .header{
      background: radial-gradient(900px 340px at 20% 0%, rgba(255,255,255,0.16), transparent 45%),
                  linear-gradient(135deg, var(--red) 0%, var(--red2) 100%);
      padding: 18px 16px 14px;
      text-align:center;
    }

    .logo{
      width:66px; height:66px;
      margin: 0 auto 10px;
      background: rgba(255,255,255,0.95);
      border-radius: 14px;
      padding: 8px;
      box-shadow: 0 10px 26px rgba(0,0,0,0.22);
      border: 1px solid rgba(255,255,255,0.55);
    }
    .logo img{ width:100%; height:100%; object-fit:contain; }

    .header-title{
      color:#fff;
      font-size: 20px;
      font-weight: 900;
      letter-spacing: 0.2px;
      margin-bottom: 3px;
    }
    .header-subtitle{
      color: rgba(255,255,255,0.92);
      font-size: 12px;
      line-height: 1.35;
    }

    .content{
      padding: 16px 14px 18px;
    }

    .section{
      margin-bottom: 16px;
      opacity:0;
      transform: translateY(8px);
      animation: fadeInUp 0.32s ease forwards;
    }
    @keyframes fadeInUp { to{ opacity:1; transform: translateY(0); } }

    .section-title{
      font-size: 15px;
      font-weight: 900;
      color: var(--text);
      margin-bottom: 2px;
    }
    .section-subtitle{
      font-size: 12px;
      color: var(--muted);
      margin-bottom: 10px;
      line-height: 1.35;
    }

    .required-pill{
      display:inline-flex;
      align-items:center;
      gap:6px;
      margin-top: 8px;
      font-size: 11px;
      font-weight: 800;
      color: #7f1d1d;
      background: #fee2e2;
      border: 1px solid #fecaca;
      padding: 4px 10px;
      border-radius: 999px;
    }

    .error-banner{
      display:none;
      margin-bottom: 12px;
      background: #fff1f2;
      border: 1px solid #fecdd3;
      color: #881337;
      padding: 10px 12px;
      border-radius: var(--radius-sm);
      font-size: 12px;
      line-height: 1.4;
      box-shadow: var(--shadow-1);
    }
    .error-banner.show{ display:block; }

    button{
      font-family: inherit;
      border: none;
      background: none;
      padding: 0;
      color: inherit;
    }
    button:focus-visible{
      outline: none;
      box-shadow: 0 0 0 4px rgba(37,99,235,0.18);
      border-radius: 12px;
    }

    /* Emoji */
    .emoji-container{
      display:flex;
      justify-content: space-between;
      gap: 6px;
      padding: 12px 10px;
      border-radius: var(--radius-lg);
      background:
        radial-gradient(600px 160px at 20% 0%, rgba(220,38,38,0.10), transparent 55%),
        linear-gradient(180deg, #ffffff 0%, #f8fafc 100%);
      border: 1px solid var(--border);
      box-shadow: var(--shadow-1);
    }

    .emoji-wrapper{ flex:1; display:flex; flex-direction:column; align-items:center; gap: 6px; }

    .emoji-btn{
      width: 56px;
      height: 56px;
      border-radius: 16px;
      display:grid;
      place-items:center;
      cursor:pointer;
      transition: transform 0.2s ease, box-shadow 0.2s ease, background 0.2s ease, border 0.2s ease;
      border: 1px solid transparent;
      background: rgba(2,6,23,0.02);
    }
    .emoji-btn:active{ transform: translateY(1px) scale(0.98); }
    .emoji-btn span{ font-size: 34px; filter: grayscale(1); opacity: 0.45; transition: 0.22s ease; }

    .emoji-wrapper.active-wrapper .emoji-btn{
      background: rgba(220,38,38,0.10);
      border: 1px solid rgba(220,38,38,0.24);
      box-shadow: 0 10px 22px rgba(220,38,38,0.16);
      transform: translateY(-1px);
    }
    .emoji-wrapper.active-wrapper .emoji-btn span{
      filter: grayscale(0);
      opacity: 1;
      transform: scale(1.08);
    }

    .emoji-label{
      font-size: 10px;
      font-weight: 900;
      color: #94a3b8;
      text-align:center;
      line-height:1.15;
      letter-spacing: 0.1px;
    }
    .emoji-wrapper.active-wrapper .emoji-label{ color: var(--red); }

    /* Orders */
    .order-grid{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
    }

    .order-card{
      position:relative;
      padding: 14px 10px;
      border-radius: var(--radius-md);
      border: 1px solid var(--border);
      background:
        radial-gradient(420px 160px at 20% 0%, rgba(2,6,23,0.04), transparent 60%),
        linear-gradient(180deg, #ffffff 0%, #f8fafc 100%);
      box-shadow: var(--shadow-1);
      cursor:pointer;
      transition: transform 0.18s ease, box-shadow 0.18s ease, border 0.18s ease;
      text-align:center;
      user-select:none;
    }
    .order-card:active{ transform: translateY(1px); box-shadow: var(--shadow-press); }

    .order-icon{ font-size: 34px; margin-bottom: 6px; filter: drop-shadow(0 6px 10px rgba(0,0,0,0.12)); }
    .order-text{ font-size: 14px; font-weight: 1000; color: var(--text); margin-bottom: 2px; }
    .order-subtext{ font-size: 11px; color: var(--muted); font-weight: 700; }

    .order-card.selected{
      border: 1px solid rgba(220,38,38,0.35);
      box-shadow: 0 14px 28px rgba(220,38,38,0.18);
      transform: translateY(-1px);
    }
    .order-card.selected::before{
      content:'';
      position:absolute;
      inset:0;
      border-radius: inherit;
      background: radial-gradient(500px 220px at 20% 0%, rgba(255,255,255,0.14), transparent 55%),
                  linear-gradient(135deg, rgba(220,38,38,0.95) 0%, rgba(153,27,27,0.95) 100%);
      z-index:0;
    }
    .order-card.selected > *{ position:relative; z-index:1; }
    .order-card.selected .order-text,
    .order-card.selected .order-subtext{ color:#fff; }

    /* Other spans full width */
    .order-card[data-order="other"]{ grid-column: 1 / -1; }

    .other-input-wrap{ display:none; margin-top: 10px; }
    .other-input-wrap.show{ display:block; }
    .text-input{
      width:100%;
      padding: 12px 12px;
      border-radius: var(--radius-sm);
      border: 1px solid var(--border-strong);
      background: #f8fafc;
      font-size: 13px;
      font-weight: 700;
      transition: box-shadow 0.2s ease, border 0.2s ease, background 0.2s ease;
    }
    .text-input:focus{
      outline:none;
      border-color: rgba(220,38,38,0.35);
      background:#fff;
      box-shadow: 0 0 0 4px var(--ring);
    }

    .expand-section{
      max-height:0;
      overflow:hidden;
      transition: max-height 0.35s cubic-bezier(0.4,0,0.2,1);
      margin-top: 10px;
    }
    .expand-section.show{ max-height: 900px; }

    .label-strong{
      font-size: 13px;
      font-weight: 1000;
      color: #0f172a;
      margin-bottom: 8px;
      letter-spacing: 0.1px;
    }
    .label-note{ font-weight: 800; color: #64748b; }

    /* Filling */
    .variant-grid{
      display:grid;
      grid-template-columns: repeat(2,1fr);
      gap: 8px;
      padding: 10px;
      border-radius: var(--radius-md);
      border: 1px solid rgba(34,197,94,0.22);
      background:
        radial-gradient(520px 180px at 20% 0%, rgba(34,197,94,0.10), transparent 55%),
        linear-gradient(180deg, #ffffff 0%, #f0fdf4 100%);
      box-shadow: var(--shadow-1);
    }
    .variant-btn{
      padding: 10px 8px;
      border-radius: 12px;
      border: 1px solid rgba(34,197,94,0.25);
      background: rgba(255,255,255,0.92);
      box-shadow: 0 8px 18px rgba(0,0,0,0.06);
      cursor:pointer;
      transition: transform 0.18s ease, box-shadow 0.18s ease, border 0.18s ease, background 0.18s ease;
      font-size: 12px;
      font-weight: 950;
      color: #14532d;
      text-align:center;
      user-select:none;
    }
    .variant-btn:active{ transform: translateY(1px); }
    .variant-btn.selected{
      border: 1px solid rgba(34,197,94,0.55);
      background: linear-gradient(135deg, rgba(34,197,94,0.18) 0%, rgba(34,197,94,0.10) 100%);
      box-shadow: 0 14px 26px rgba(34,197,94,0.16);
    }

    /* Chips */
    .chip-grid{
      display:flex;
      flex-wrap:wrap;
      gap: 8px;
      padding: 10px;
      border-radius: var(--radius-md);
      border: 1px solid rgba(251,191,36,0.30);
      background:
        radial-gradient(560px 200px at 20% 0%, rgba(251,191,36,0.14), transparent 55%),
        linear-gradient(180deg, #ffffff 0%, #fffbeb 100%);
      box-shadow: var(--shadow-1);
    }
    .chip{
      padding: 9px 12px;
      border-radius: 999px;
      border: 1px solid rgba(2,6,23,0.12);
      background: rgba(255,255,255,0.90);
      box-shadow: 0 10px 20px rgba(0,0,0,0.06);
      cursor:pointer;
      transition: transform 0.18s ease, box-shadow 0.18s ease, border 0.18s ease, background 0.18s ease;
      font-size: 11px;
      font-weight: 950;
      color: #0f172a;
      user-select:none;
      white-space: nowrap;
    }
    .chip:active{ transform: translateY(1px); }
    .chip.selected{
      border: 1px solid rgba(220,38,38,0.38);
      background: linear-gradient(135deg, rgba(220,38,38,0.16) 0%, rgba(220,38,38,0.08) 100%);
      box-shadow: 0 16px 28px rgba(220,38,38,0.14);
    }

    .feedback-box{
      width:100%;
      min-height: 84px;
      padding: 12px 12px;
      border-radius: var(--radius-sm);
      border: 1px solid var(--border-strong);
      background: #f8fafc;
      font-size: 13px;
      font-weight: 650;
      resize: vertical;
      transition: box-shadow 0.2s ease, border 0.2s ease, background 0.2s ease;
    }
    .feedback-box:focus{
      outline:none;
      border-color: rgba(220,38,38,0.35);
      background:#fff;
      box-shadow: 0 0 0 4px var(--ring);
    }
    .char-count{
      text-align:right;
      margin-top: 6px;
      font-size: 11px;
      color: #94a3b8;
      font-weight: 800;
    }

    .submit-btn{
      width:100%;
      padding: 16px 14px;
      border-radius: 16px;
      background: radial-gradient(900px 260px at 20% 0%, rgba(255,255,255,0.16), transparent 55%),
                  linear-gradient(135deg, var(--red) 0%, var(--red2) 100%);
      color:#fff;
      font-size: 16px;
      font-weight: 1000;
      letter-spacing: 0.2px;
      cursor:pointer;
      box-shadow: 0 16px 34px rgba(220,38,38,0.30);
      transition: transform 0.18s ease, box-shadow 0.18s ease, filter 0.18s ease;
    }
    .submit-btn:active{
      transform: translateY(1px);
      box-shadow: 0 10px 22px rgba(220,38,38,0.28);
      filter: saturate(1.05);
    }
    .submit-btn:disabled{
      cursor:not-allowed;
      background: linear-gradient(135deg, #9ca3af 0%, #6b7280 100%);
      box-shadow: none;
      transform: none;
    }

    .loader{
      display:inline-block;
      width:18px;
      height:18px;
      border: 3px solid rgba(255,255,255,0.35);
      border-top-color: #fff;
      border-radius: 50%;
      animation: spin 0.7s linear infinite;
    }
    @keyframes spin{ to{ transform: rotate(360deg); } }

    .success-screen{
      display:none;
      text-align:center;
      padding: 26px 18px 28px;
      animation: fadeInUp 0.35s ease;
    }
    .success-screen.show{ display:block; }
    .success-icon{ font-size: 62px; margin-bottom: 12px; animation: bounce 0.6s ease; }
    @keyframes bounce{ 0%,100%{ transform: translateY(0);} 50%{ transform: translateY(-9px);} }
    .success-title{ font-size: 24px; font-weight: 1000; color: var(--text); margin-bottom: 6px; }
    .success-subtitle{ font-size: 14px; color: var(--muted); line-height: 1.45; margin-bottom: 14px; }

    .google-prompt{ display:none; margin-top: 10px; }
    .google-btn{
      display:inline-flex;
      align-items:center;
      justify-content:center;
      gap: 10px;
      padding: 14px 18px;
      border-radius: 14px;
      text-decoration:none;
      background: radial-gradient(900px 240px at 20% 0%, rgba(255,255,255,0.18), transparent 55%),
                  linear-gradient(135deg, #4285f4 0%, #1967d2 100%);
      color:#fff;
      font-size: 14px;
      font-weight: 950;
      box-shadow: 0 16px 30px rgba(25,103,210,0.22);
      transition: transform 0.18s ease, box-shadow 0.18s ease;
    }
    .google-btn:active{ transform: translateY(1px); box-shadow: 0 10px 22px rgba(25,103,210,0.22); }

    .footer{
      text-align:center;
      padding: 12px;
      color: rgba(255,255,255,0.92);
      font-size: 11px;
      line-height: 1.5;
    }
  </style>
</head>

<body>
  <div class="container">
    <div class="header">
      <div class="logo">
        <img alt="Kimchi Cloud" id="logoImg" />
      </div>
      <div class="header-title">‡§§‡•Å‡§Æ‡§ö‡§æ ‡§Ö‡§®‡•Å‡§≠‡§µ ‡§∂‡•á‡§Ö‡§∞ ‡§ï‡§∞‡§æ</div>
      <div class="header-subtitle">Share your experience</div>
    </div>

    <div class="content" id="formContent">
      <div class="error-banner" id="errorBanner"></div>

      <!-- Rating -->
      <div class="section" style="animation-delay:0.05s">
        <div class="section-title">‡§Ü‡§ú‡§ö‡§æ ‡§Ö‡§®‡•Å‡§≠‡§µ ‡§ï‡§∏‡§æ ‡§π‡•ã‡§§‡§æ?</div>
        <div class="section-subtitle">How was your experience?</div>
        <div class="required-pill">* ‡§Ü‡§µ‡§∂‡•ç‡§Ø‡§ï / Required</div>

        <div class="emoji-container" id="emojiRating" style="margin-top:10px;">
          <div class="emoji-wrapper">
            <button class="emoji-btn" type="button" data-rating="1" aria-label="‡§µ‡§æ‡§à‡§ü / Poor"><span>üòû</span></button>
            <div class="emoji-label">‡§µ‡§æ‡§à‡§ü<br/>Poor</div>
          </div>
          <div class="emoji-wrapper">
            <button class="emoji-btn" type="button" data-rating="2" aria-label="‡§†‡•Ä‡§ï‡§†‡§æ‡§ï / Fair"><span>üòê</span></button>
            <div class="emoji-label">‡§†‡•Ä‡§ï‡§†‡§æ‡§ï<br/>Fair</div>
          </div>
          <div class="emoji-wrapper">
            <button class="emoji-btn" type="button" data-rating="3" aria-label="‡§ö‡§æ‡§Ç‡§ó‡§≤‡§Ç / Good"><span>üôÇ</span></button>
            <div class="emoji-label">‡§ö‡§æ‡§Ç‡§ó‡§≤‡§Ç<br/>Good</div>
          </div>
          <div class="emoji-wrapper">
            <button class="emoji-btn" type="button" data-rating="4" aria-label="‡§ñ‡•Ç‡§™ ‡§õ‡§æ‡§® / Great"><span>üòä</span></button>
            <div class="emoji-label">‡§ñ‡•Ç‡§™ ‡§õ‡§æ‡§®<br/>Great</div>
          </div>
          <div class="emoji-wrapper">
            <button class="emoji-btn" type="button" data-rating="5" aria-label="‡§â‡§§‡•ç‡§§‡§Æ / Excellent"><span>ü§©</span></button>
            <div class="emoji-label">‡§â‡§§‡•ç‡§§‡§Æ<br/>Excellent</div>
          </div>
        </div>
      </div>

      <!-- Order -->
      <div class="section" style="animation-delay:0.10s">
        <div class="section-title">‡§§‡•Å‡§Æ‡•ç‡§π‡•Ä ‡§ï‡§æ‡§Ø ‡§ë‡§∞‡•ç‡§°‡§∞ ‡§ï‡•á‡§≤‡§Ç?</div>
        <div class="section-subtitle">What did you order?</div>
        <div class="required-pill">* ‡§Ü‡§µ‡§∂‡•ç‡§Ø‡§ï / Required</div>

        <div class="order-grid" style="margin-top:10px;">
          <button class="order-card" type="button" data-order="dumplings" aria-label="‡§°‡§Ç‡§™‡§≤‡§ø‡§Ç‡§ó / Dumplings">
            <div class="order-icon">ü•ü</div>
            <div class="order-text">‡§°‡§Ç‡§™‡§≤‡§ø‡§Ç‡§ó</div>
            <div class="order-subtext">Dumplings</div>
          </button>

          <button class="order-card" type="button" data-order="fries" aria-label="‡§´‡•ç‡§∞‡•á‡§Ç‡§ö ‡§´‡•ç‡§∞‡§æ‡§à‡§ú / French Fries">
            <div class="order-icon">üçü</div>
            <div class="order-text">‡§´‡•ç‡§∞‡•á‡§Ç‡§ö ‡§´‡•ç‡§∞‡§æ‡§à‡§ú</div>
            <div class="order-subtext">French Fries</div>
          </button>

          <button class="order-card" type="button" data-order="other" aria-label="‡§á‡§§‡§∞ / Other">
            <div class="order-icon">üçΩÔ∏è</div>
            <div class="order-text">‡§á‡§§‡§∞</div>
            <div class="order-subtext">Other</div>
          </button>
        </div>

        <div class="other-input-wrap" id="otherOrderWrap">
          <input class="text-input" id="otherOrderText" type="text" maxlength="50"
                 placeholder="‡§á‡§§‡§∞ ‡§ï‡§æ‡§Ø? (‡§â‡§¶‡§æ. ‡§°‡•ç‡§∞‡§ø‡§Ç‡§ï) / What other item?" />
        </div>

        <!-- Dumpling details -->
        <div class="expand-section" id="dumplingDetails">
          <div style="margin-top:12px;">
            <div class="label-strong">‡§≠‡§∞‡§æ‡§µ ‡§®‡§ø‡§µ‡§°‡§æ (Filling) <span class="label-note">‚Äî ‡§è‡§ï‡§ö ‡§®‡§ø‡§µ‡§°‡§æ</span></div>
            <div class="variant-grid" id="fillingGrid">
              <button class="variant-btn" type="button" data-filling="veggies">ü•¨ ‡§µ‡•á‡§ú<br><span style="font-size:10px;font-weight:800;opacity:.9">Veg</span></button>
              <button class="variant-btn" type="button" data-filling="paneer">üßÄ ‡§™‡§®‡•Ä‡§∞<br><span style="font-size:10px;font-weight:800;opacity:.9">Paneer</span></button>
              <button class="variant-btn" type="button" data-filling="corncheese">üåΩ ‡§ï‡•â‡§∞‡•ç‡§® ‡§ö‡•Ä‡§ú<br><span style="font-size:10px;font-weight:800;opacity:.9">Corn Cheese</span></button>
              <button class="variant-btn" type="button" data-filling="chicken">üçó ‡§ö‡§ø‡§ï‡§®<br><span style="font-size:10px;font-weight:800;opacity:.9">Chicken</span></button>
            </div>
          </div>

          <div class="expand-section" id="styleSection">
            <div style="margin-top:12px;">
              <div class="label-strong">‡§∏‡•ç‡§ü‡§æ‡§à‡§≤/‡§´‡•ç‡§≤‡•á‡§µ‡§∞ ‡§®‡§ø‡§µ‡§°‡§æ (Style/Flavour) <span class="label-note">‚Äî ‡§è‡§ï‡§ö ‡§®‡§ø‡§µ‡§°‡§æ</span></div>
              <div class="chip-grid" id="styleGrid">
                <button class="chip" type="button" data-style="kimchi-special">Kimchi Special</button>
                <button class="chip" type="button" data-style="steam">Steam</button>
                <button class="chip" type="button" data-style="fried">Fried</button>
                <button class="chip" type="button" data-style="schezwan">Schezwan</button>
                <button class="chip" type="button" data-style="peri-peri">Peri-Peri</button>
                <button class="chip" type="button" data-style="jhol">Jhol</button>
                <button class="chip" type="button" data-style="malai">Malai</button>
                <button class="chip" type="button" data-style="triple-cheese">Triple Cheese</button>
                <button class="chip" type="button" data-style="kurkure">Kurkure</button>
                <button class="chip" type="button" data-style="peri-peri-fried">Peri-Peri Fried</button>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Like most -->
      <div class="section" style="animation-delay:0.14s">
        <div class="section-title">‡§∏‡§∞‡•ç‡§µ‡§æ‡§§ ‡§ú‡§æ‡§∏‡•ç‡§§ ‡§ï‡§æ‡§Ø ‡§Ü‡§µ‡§°‡§≤‡§Ç? <span style="font-size:12px;color:#94a3b8;font-weight:900;">(‡§ê‡§ö‡•ç‡§õ‡§ø‡§ï)</span></div>
        <div class="section-subtitle">What did you like the most? (Optional)</div>

        <div class="chip-grid" id="likeMostGrid" style="border-color: rgba(99,102,241,0.25);
          background: radial-gradient(560px 200px at 20% 0%, rgba(99,102,241,0.16), transparent 55%), linear-gradient(180deg,#ffffff 0%, #eef2ff 100%);">
          <button class="chip" type="button" data-like="taste">‡§ö‡§µ / Taste</button>
          <button class="chip" type="button" data-like="quantity">‡§™‡•ç‡§∞‡§Æ‡§æ‡§£ / Quantity</button>
          <button class="chip" type="button" data-like="price">‡§ï‡§ø‡§Ç‡§Æ‡§§ / Price</button>
          <button class="chip" type="button" data-like="service">‡§∏‡§∞‡•ç‡§µ‡•ç‡§π‡§ø‡§∏ / Service</button>
          <button class="chip" type="button" data-like="hygiene">‡§∏‡•ç‡§µ‡§ö‡•ç‡§õ‡§§‡§æ / Hygiene</button>
          <button class="chip" type="button" data-like="packaging">‡§™‡•Ö‡§ï‡•á‡§ú‡§ø‡§Ç‡§ó / Packaging</button>
        </div>
      </div>

      <!-- Improve (only for 1-3 rating) -->
      <div class="section" id="improveSection" style="display:none; animation-delay:0.16s">
        <div class="section-title">‡§ï‡§æ‡§Ø ‡§∏‡•Å‡§ß‡§æ‡§∞‡§æ‡§Ø‡§≤‡§æ ‡§π‡§µ‡§Ç? <span style="font-size:12px;color:#94a3b8;font-weight:900;">(‡§ê‡§ö‡•ç‡§õ‡§ø‡§ï)</span></div>
        <div class="section-subtitle">What should we improve? (Optional)</div>

        <div class="chip-grid" id="improveGrid" style="border-color: rgba(244,63,94,0.25);
          background: radial-gradient(560px 200px at 20% 0%, rgba(244,63,94,0.16), transparent 55%), linear-gradient(180deg,#ffffff 0%, #fff1f2 100%);">
          <button class="chip" type="button" data-improve="taste">‡§ö‡§µ / Taste</button>
          <button class="chip" type="button" data-improve="spice">‡§§‡§ø‡§ñ‡§ü / Spice</button>
          <button class="chip" type="button" data-improve="wait">‡§µ‡•á‡§ü‡§ø‡§Ç‡§ó / Wait</button>
          <button class="chip" type="button" data-improve="staff">‡§∏‡•ç‡§ü‡§æ‡§´ / Staff</button>
          <button class="chip" type="button" data-improve="cleanliness">‡§∏‡•ç‡§µ‡§ö‡•ç‡§õ‡§§‡§æ / Cleanliness</button>
          <button class="chip" type="button" data-improve="price">‡§ï‡§ø‡§Ç‡§Æ‡§§ / Price</button>
          <button class="chip" type="button" data-improve="other">‡§á‡§§‡§∞ / Other</button>
        </div>

        <div class="other-input-wrap" id="improveOtherWrap">
          <input class="text-input" id="improveOtherText" type="text" maxlength="60"
                 placeholder="‡§á‡§§‡§∞ ‡§ï‡§æ‡§Ø? / What else should we improve?" />
        </div>
      </div>

      <!-- Feedback -->
      <div class="section" style="animation-delay:0.20s">
        <div class="section-title">‡§Ö‡§≠‡§ø‡§™‡•ç‡§∞‡§æ‡§Ø <span style="font-size:12px;color:#94a3b8;font-weight:900;">(‡§ê‡§ö‡•ç‡§õ‡§ø‡§ï)</span></div>
        <div class="section-subtitle">Your feedback (Optional)</div>

        <textarea class="feedback-box" id="feedback" maxlength="200"
          placeholder="‡§ö‡§µ, ‡§™‡•ç‡§∞‡§Æ‡§æ‡§£, ‡§Æ‡§∏‡§æ‡§≤‡§æ, ‡§µ‡•á‡§ü‡§ø‡§Ç‡§ó... ‡§ï‡§æ‡§π‡•Ä‡§π‡•Ä ‡§≤‡§ø‡§π‡§æ.&#10;Taste, quantity, spice, waiting... write anything."></textarea>
        <div class="char-count"><span id="charCount">0</span>/200</div>
      </div>

      <button class="submit-btn" id="submitBtn" disabled>‡§∏‡§¨‡§Æ‡§ø‡§ü ‡§ï‡§∞‡§æ ‚ú® / Submit</button>
    </div>

    <!-- Success Screen -->
    <div class="success-screen" id="successScreen">
      <div class="success-icon">üéâ</div>
      <div class="success-title">‡§ß‡§®‡•ç‡§Ø‡§µ‡§æ‡§¶!</div>
      <div class="success-subtitle" id="successMsg">
        ‡§§‡•Å‡§Æ‡§ö‡§æ ‡§Ö‡§≠‡§ø‡§™‡•ç‡§∞‡§æ‡§Ø ‡§Ü‡§Æ‡•ç‡§π‡§æ‡§≤‡§æ ‡§∏‡•Å‡§ß‡§æ‡§∞‡§æ‡§Ø‡§≤‡§æ ‡§Æ‡§¶‡§§ ‡§ï‡§∞‡§§‡•ã.<br/>Your feedback helps us improve.
      </div>

      <!-- Only shown if rating is 4 or 5 -->
      <div class="google-prompt" id="googlePrompt">
        <div class="success-subtitle" style="margin-bottom:12px;">
          ‡§Ü‡§µ‡§°‡§≤‡§Ç ‡§Ö‡§∏‡•á‡§≤ ‡§§‡§∞ Google ‡§µ‡§∞ 1 ‡§Æ‡§ø‡§®‡§ø‡§ü‡§æ‡§§ ‡§∞‡§ø‡§µ‡•ç‡§π‡•ç‡§Ø‡•Ç ‡§¶‡•ç‡§Ø‡§æ üôå<br/>
          Leave a quick Google review üôå
        </div>

        <a class="google-btn" id="googleReviewBtn" target="_blank" rel="noopener">
          <svg width="20" height="20" viewBox="0 0 48 48" fill="none" aria-hidden="true">
            <path d="M44 24c0 11.045-8.955 20-20 20S4 35.045 4 24 12.955 4 24 4c4.918 0 9.416 1.777 12.896 4.72l-5.219 5.022C29.873 12.103 27.076 11 24 11c-7.18 0-13 5.82-13 13s5.82 13 13 13c5.633 0 10.425-3.59 12.214-8.613H24v-7.075h20v3.35c0 .408-.033.81-.098 1.206A19.905 19.905 0 0 1 44 24z" fill="white"/>
          </svg>
          Google Review
        </a>
      </div>
    </div>
  </div>

  <div class="footer">
    ü•ü Kimchi Cloud, Chandrapur<br/>
    Daily: 5:00 PM - 10:00 PM
  </div>

  <script>
    // ‚úÖ Integrated links
    const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycby52ne8pDN4m-fZyqD3zqlW13veShYEzRvj4xQUvhGekQUFCWMd4uFC-STOL8G9zKCW/exec';
    // 'https://script.google.com/macros/s/AKfycbw_ja5MEwQPdpynDr0onrNSnrcpZl7Er7EjP_Gqk2RfvsQ8v3QjVaVzt9V02qQTDE5d/exec';
    const GOOGLE_REVIEW_URL = 'https://search.google.com/local/writereview?placeid=ChIJz5u4c3HV0jsRhC7ZVhO4ID8';
    const DRIVE_FILE_ID = '1FCHvdR0SQKH-B7bgNuYg3wXsN4LzbC89';

    // Drive "view" links don't load as images reliably. Use direct:
    const LOGO_URL_PRIMARY = `https://lh3.googleusercontent.com/d/${DRIVE_FILE_ID}`;
    const LOGO_URL_FALLBACK = `https://drive.google.com/uc?export=view&id=${DRIVE_FILE_ID}`;

    const formData = {
      rating: 0,
      orders: [],
      otherOrderText: '',
      dumplingFilling: '',
      dumplingStyle: '',
      likeMost: '',
      improveNeed: '',
      improveOtherText: '',
      feedback: '',
      source: 'kimchi-cloud-feedback',
      userAgent: navigator.userAgent
    };

    const $ = (id) => document.getElementById(id);

    // Set logo + fallback
    const logoImg = $('logoImg');
    logoImg.src = LOGO_URL_PRIMARY;
    logoImg.onerror = function () {
      if (this.src !== LOGO_URL_FALLBACK) {
        this.src = LOGO_URL_FALLBACK;
      } else {
        this.src = 'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><text y="60" x="50" text-anchor="middle" font-size="50">ü•ü</text></svg>';
      }
    };

    // Set Google review link
    $('googleReviewBtn').href = GOOGLE_REVIEW_URL;

    const errorBanner = $('errorBanner');
    function showError(msg){
      errorBanner.textContent = msg;
      errorBanner.classList.add('show');
      window.scrollTo({ top: 0, behavior: 'smooth' });
    }
    function clearError(){
      errorBanner.textContent = '';
      errorBanner.classList.remove('show');
    }

    const submitBtn = $('submitBtn');
    function updateSubmitState(){
      submitBtn.disabled = !(formData.rating > 0 && formData.orders.length > 0);
    }

    // Rating
    const emojiBtns = document.querySelectorAll('.emoji-btn');
    emojiBtns.forEach(btn => {
      btn.addEventListener('click', () => {
        clearError();
        const rating = parseInt(btn.dataset.rating, 10);
        formData.rating = rating;

        document.querySelectorAll('.emoji-wrapper').forEach(w => w.classList.remove('active-wrapper'));
        btn.closest('.emoji-wrapper')?.classList.add('active-wrapper');

        // Improve section only for 1-3
        const improveSection = $('improveSection');
        if (rating <= 3) {
          improveSection.style.display = 'block';
        } else {
          improveSection.style.display = 'none';
          formData.improveNeed = '';
          formData.improveOtherText = '';
          $('improveOtherWrap').classList.remove('show');
          $('improveOtherText').value = '';
          document.querySelectorAll('#improveGrid .chip').forEach(c => c.classList.remove('selected'));
        }

        updateSubmitState();
      });
    });

    // Orders (multi-select)
    const orderCards = document.querySelectorAll('.order-card');
    const dumplingDetails = $('dumplingDetails');
    const styleSection = $('styleSection');
    const otherOrderWrap = $('otherOrderWrap');
    const otherOrderText = $('otherOrderText');

    function isSelectedOrder(order){ return formData.orders.includes(order); }

    function syncDumplingVisibility(){
      if (isSelectedOrder('dumplings')) {
        dumplingDetails.classList.add('show');
      } else {
        dumplingDetails.classList.remove('show');
        styleSection.classList.remove('show');
        formData.dumplingFilling = '';
        formData.dumplingStyle = '';
        document.querySelectorAll('.variant-btn').forEach(b => b.classList.remove('selected'));
        document.querySelectorAll('#styleGrid .chip').forEach(b => b.classList.remove('selected'));
      }
    }

    function syncOtherVisibility(){
      if (isSelectedOrder('other')) {
        otherOrderWrap.classList.add('show');
      } else {
        otherOrderWrap.classList.remove('show');
        formData.otherOrderText = '';
        otherOrderText.value = '';
      }
    }

    orderCards.forEach(card => {
      card.addEventListener('click', () => {
        clearError();
        const order = card.dataset.order;

        if (card.classList.contains('selected')) {
          card.classList.remove('selected');
          formData.orders = formData.orders.filter(o => o !== order);
        } else {
          card.classList.add('selected');
          formData.orders.push(order);
        }

        syncDumplingVisibility();
        syncOtherVisibility();
        updateSubmitState();
      });
    });

    otherOrderText.addEventListener('input', () => {
      formData.otherOrderText = otherOrderText.value.trim();
    });

    // Filling (single select)
    const fillingBtns = document.querySelectorAll('.variant-btn');
    fillingBtns.forEach(btn => {
      btn.addEventListener('click', () => {
        clearError();
        fillingBtns.forEach(b => b.classList.remove('selected'));
        btn.classList.add('selected');
        formData.dumplingFilling = btn.dataset.filling;
        setTimeout(() => styleSection.classList.add('show'), 80);
      });
    });

    // Style (single select)
    const styleChips = document.querySelectorAll('#styleGrid .chip');
    styleChips.forEach(chip => {
      chip.addEventListener('click', () => {
        styleChips.forEach(c => c.classList.remove('selected'));
        chip.classList.add('selected');
        formData.dumplingStyle = chip.dataset.style;
      });
    });

    // Like most (single select)
    const likeMostChips = document.querySelectorAll('#likeMostGrid .chip');
    likeMostChips.forEach(chip => {
      chip.addEventListener('click', () => {
        likeMostChips.forEach(c => c.classList.remove('selected'));
        chip.classList.add('selected');
        formData.likeMost = chip.dataset.like;
      });
    });

    // Improve (single select + other text)
    const improveChips = document.querySelectorAll('#improveGrid .chip');
    const improveOtherWrap = $('improveOtherWrap');
    const improveOtherText = $('improveOtherText');

    improveChips.forEach(chip => {
      chip.addEventListener('click', () => {
        improveChips.forEach(c => c.classList.remove('selected'));
        chip.classList.add('selected');
        formData.improveNeed = chip.dataset.improve;

        if (formData.improveNeed === 'other') {
          improveOtherWrap.classList.add('show');
        } else {
          improveOtherWrap.classList.remove('show');
          formData.improveOtherText = '';
          improveOtherText.value = '';
        }
      });
    });

    improveOtherText.addEventListener('input', () => {
      formData.improveOtherText = improveOtherText.value.trim();
    });

    // Feedback
    const feedbackBox = $('feedback');
    const charCount = $('charCount');
    feedbackBox.addEventListener('input', () => {
      formData.feedback = feedbackBox.value;
      charCount.textContent = feedbackBox.value.length;
    });

    function showSuccess(){
      $('formContent').style.display = 'none';
      $('successScreen').classList.add('show');

      const rating = formData.rating;
      const googlePrompt = $('googlePrompt');
      const successMsg = $('successMsg');

      // Google prompt ONLY here for 4-5
      if (rating >= 4) {
        googlePrompt.style.display = 'block';
        successMsg.innerHTML = '‡§§‡•Å‡§Æ‡§ö‡§æ ‡§Ö‡§≠‡§ø‡§™‡•ç‡§∞‡§æ‡§Ø ‡§Ü‡§Æ‡•ç‡§π‡§æ‡§≤‡§æ ‡§∏‡•Å‡§ß‡§æ‡§∞‡§æ‡§Ø‡§≤‡§æ ‡§Æ‡§¶‡§§ ‡§ï‡§∞‡§§‡•ã.<br/>Your feedback helps us improve.';
      } else {
        googlePrompt.style.display = 'none';
        successMsg.innerHTML = '‡§ß‡§®‡•ç‡§Ø‡§µ‡§æ‡§¶! ‡§Ü‡§Æ‡•ç‡§π‡•Ä ‡§®‡§ï‡•ç‡§ï‡•Ä ‡§∏‡•Å‡§ß‡§æ‡§∞‡•Ç üôè<br/>Thanks ‚Äî we‚Äôll improve üôè';
      }
    }

async function submitToAppsScript(payload) {
  const json = JSON.stringify(payload);

  // 1) Best-effort: sendBeacon (very reliable on mobile QR flows)
  try {
    if (navigator.sendBeacon) {
      const blob = new Blob([json], { type: 'text/plain;charset=utf-8' });
      const queued = navigator.sendBeacon(SCRIPT_URL, blob);
      if (queued) return { success: true, method: 'beacon' };
      // if queued=false, fall back to fetch
    }
  } catch (e) {
    // fall back to fetch
  }

  // 2) Fallback: fetch no-cors
  await fetch(SCRIPT_URL, {
    method: 'POST',
    mode: 'no-cors',
    keepalive: true,
    headers: { 'Content-Type': 'text/plain;charset=utf-8' },
    body: json
  });

  return { success: true, method: 'fetch' };
}

submitBtn.addEventListener('click', async () => {
  clearError();

  if (formData.rating === 0) {
    showError('‡§ï‡•É‡§™‡§Ø‡§æ ‡§∞‡•á‡§ü‡§ø‡§Ç‡§ó ‡§¶‡•ç‡§Ø‡§æ. / Please select a rating.');
    return;
  }
  if (formData.orders.length === 0) {
    showError('‡§ï‡•É‡§™‡§Ø‡§æ ‡§§‡•Å‡§Æ‡•ç‡§π‡•Ä ‡§ï‡§æ‡§Ø ‡§ë‡§∞‡•ç‡§°‡§∞ ‡§ï‡•á‡§≤‡§Ç ‡§§‡•á ‡§®‡§ø‡§µ‡§°‡§æ. / Please select what you ordered.');
    return;
  }

  submitBtn.disabled = true;
  const originalText = submitBtn.textContent;
  submitBtn.innerHTML = '<span class="loader"></span>';

  const payload = { ...formData, submittedAtISO: new Date().toISOString() };

  try {
    await submitToAppsScript(payload);
    showSuccess();
  } catch (err) {
    console.error(err);
    submitBtn.disabled = false;
    submitBtn.textContent = originalText;
    showError('‡§®‡•á‡§ü‡§µ‡§∞‡•ç‡§ï/‡§∏‡§∞‡•ç‡§µ‡•ç‡§π‡§∞ ‡§∏‡§Æ‡§∏‡•ç‡§Ø‡§æ. ‡§ï‡•É‡§™‡§Ø‡§æ ‡§™‡•Å‡§®‡•ç‡§π‡§æ ‡§™‡•ç‡§∞‡§Ø‡§§‡•ç‡§® ‡§ï‡§∞‡§æ. / Network issue ‚Äî please try again.');
  }
});

    // async function submitNoCors(payload){
    //   // Important: no-cors allows only "simple" Content-Types; use text/plain
    //   await fetch(SCRIPT_URL, {
    //     method: 'POST',
    //     mode: 'no-cors',
    //     headers: { 'Content-Type': 'text/plain;charset=utf-8' },
    //     body: JSON.stringify(payload)
    //   });
    //   // If fetch doesn't throw, we treat as submitted (can't read response in no-cors)
    //   return { success: true };
    // }

    // submitBtn.addEventListener('click', async () => {
    //   clearError();

    //   if (formData.rating === 0) {
    //     showError('‡§ï‡•É‡§™‡§Ø‡§æ ‡§∞‡•á‡§ü‡§ø‡§Ç‡§ó ‡§¶‡•ç‡§Ø‡§æ. / Please select a rating.');
    //     return;
    //   }
    //   if (formData.orders.length === 0) {
    //     showError('‡§ï‡•É‡§™‡§Ø‡§æ ‡§§‡•Å‡§Æ‡•ç‡§π‡•Ä ‡§ï‡§æ‡§Ø ‡§ë‡§∞‡•ç‡§°‡§∞ ‡§ï‡•á‡§≤‡§Ç ‡§§‡•á ‡§®‡§ø‡§µ‡§°‡§æ. / Please select what you ordered.');
    //     return;
    //   }

    //   submitBtn.disabled = true;
    //   const originalText = submitBtn.textContent;
    //   submitBtn.innerHTML = '<span class="loader"></span>';

    //   const payload = { ...formData, submittedAtISO: new Date().toISOString() };

    //   try {
    //     await submitNoCors(payload);
    //     showSuccess();
    //   } catch (err) {
    //     console.error(err);
    //     submitBtn.disabled = false;
    //     submitBtn.textContent = originalText;
    //     showError('‡§®‡•á‡§ü‡§µ‡§∞‡•ç‡§ï/‡§∏‡§∞‡•ç‡§µ‡•ç‡§π‡§∞ ‡§∏‡§Æ‡§∏‡•ç‡§Ø‡§æ. ‡§ï‡•É‡§™‡§Ø‡§æ ‡§™‡•Å‡§®‡•ç‡§π‡§æ ‡§™‡•ç‡§∞‡§Ø‡§§‡•ç‡§® ‡§ï‡§∞‡§æ. / Network issue ‚Äî please try again.');
    //   }
    // });

    updateSubmitState();
  </script>
</body>
</html>
